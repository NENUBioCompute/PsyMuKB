{% include "muttemp.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block content %}
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-bootstrap-table-en-US.min.js"></script>
    <script src="\static\bootstrap-table-export.js"></script>
    <script src="\static\tableExport.js"></script>
    <script src="\static\nav.js"></script>
    <script src="js\mt.js"></script>



    <style type="text/css">

        body {
            background-color: rgba(204, 204, 204, 0.1);
        }

        .accordion {
            border: 1px solid #ffffff;
            background-color: #ffffff;
            border-radius: 3px;
            padding: 20px;
            margin: 30px;
        }

        .little_title {
            color: #663333;
            font-size: 24px;
            font-family: "Verdana";
            padding: 5px;
            border-bottom: 3px solid #663333;
        }

        .col-md-12 {
            margin-top: 10px;
        }

        .accordion-heading {
            background: url('../static/subtitle.png') no-repeat;
            background-size: 400px 50px;
            height: 50px;
            width: 400px;
            display: inline-block;
            vertical-align: middle;
            color: #fff;
            padding-left: 40px;
        }

        .row {
            margin-top: 20px;
        }

        /*fixednav*/
        .fixednav {
            position: fixed;
            top: 50px;
            left: 30%;
            border-bottom-right-radius: 5px;
            border-bottom-left-radius: 5px;
            position: fixed;
            z-index: 999;
            background-color: rgba(102, 153, 153, 0.8);
        }

        header ul {
            height: 30px;
            list-style-type: none;
            padding-left: 25px;
        }

        header li {
            float: left;
            padding-right: 20px;

        }

        header li a {
            text-decoration: none;
            color: #D3D3D3;
            font-size: 15px;
            border-left: 3px solid #333333;
            padding-left: 5px;
        }

        header li a:hover {
            text-decoration: none;
            color: #FFFFFF;
            border-bottom: 3px solid #FFFFFF;
        }
    </style>
    <style>
        /*footer*/
        .footer
        {
            background-color:#669999;
            width:100%;
            display: block;
            height:200px;
             display: flex;
             margin-top:20px;
             position:relative;
        }
        .foot
        {
            height:100px;
            left:25%;
            float:left;
            font-size:15px;
            color:#fff;
            padding:0;
            position:relative;
            margin:20px;
        }
        .foot a{
            text-decoration:none;
            color:#CCCCCC;
        }
        .foot a:hover{
            text-decoration:none;
            color:#fff;
            border-bottom:3px solid  #FFFFFF;
        }
        .foot-p
        {
            position:absolute;
            top:130px;
            left:40%;
            text-align:center;
        }
        .line2
        {
            position:absolute;
            top:-30px;
            left:-25%;
            text-align:center;
        }
</style>

    <div class="container text-justify">

        <div id = "first-step">
            <center>
            <h2><b>Related Mutations Information</b></h2>
            <p> <b>Notes: You can choose one mutation type to show and select one <i>DNM</i> to review mRNA & Protein level impact information .</b></p>
            <p>
                <select id="mutaion_type">
                <option value="cdm">Coding <i>de novo</i> mutations (DNMs)</option>
                <option value="ncdm">Noncoding <i>de novo</i>mutations (DNMs)</option>
                <option value="cnv" >De novo</i> copy number variations (CNVs)</option>
                <option value="all" selected="selected">All</option>
                </select>
{#                <button class="btn btn-success mysubmit" style="margin-top: 10px;">Show</button>#}
                <button class="btn-success mutation-type" onclick="getMutationSelect()" > Show</button>
            </p>
            </center>
        </div>

        {% for j in message %}
        {% if 'DNM' in j %}
            <div id="table-cdm">
                <div class="row">
                    <div class="col-md-12">

                    <div class="little_title">
                    <table><tr>
                        <td width="70%">
                            Coding <i>de novo</i> mutations (DNMs) of
                            <i>{{ j['Symbol'] }}</i>
                        </td>
                        <td></td>
                        <td></td>
                        <td width="5%">
                            <button class="btn btn-success mysubmit"  >Submit</button>
                        </td>
                            </tr>
                    </table>
                            </div>


                        <table data-class="table table-hover" data-toggle="table" data-pagination="true"
                               data-show-pagination-switch="true" data-page-size=10 data-search="true" data-search-on-enter-key="true" data-show-refresh="true">
                            <thead style="background-color:#669999">
                            <tr>
                                <th></th>
                                <th>Chr</th>
                                <th>Position</th>
                                <th>Variant</th>
                                <th>Gene</th>
                                <th>Function</th>
                                <th>AAChange refGene</th>
                                <th>Primary Phenotype</th>
                                <th>#Probands</th>
                                <th>#Controls</th>
                                <th>Study</th>
                                <th>Sequence type</th>
                                <th>#Individual</th>
                                <th>rsID</th>
                                <th>1000G_Freq.</th>
                                <th>ExAc Freq.</th>
                                <th>SIFT</th>
                                <th>Ployphen-2</th>
                                <th>CADD</th>
                                <th>DeepSea</th>


                            </tr>
                            </thead>
                            <tbody>
                            {% for i in j['DNM'] %}
                                {% if i['Exonic Func']!='null' %}
                                    {% if loop.index == 1 %}
                                        <tr>
                                        <td><input type="radio" name="checkItem" checked/></td>
                                        <td class="chr">{{ i['chr'] }}</td>
                                        <td class="pos">{{ i['Position'] }}</td>
                                        <td>{{ i['Variant'] }}</td>
                                        {% if i['Gene symbol'] is string %}
                                            <td>{{ i['Gene symbol'] }}</td>
                                        {% else %}
                                            <td>{{ i['Gene symbol']|join(',') }}</td>
                                        {% endif %}
                                        <td>{{ i['Exonic Func'] }}</td>
                                        <td>{{ i['AAChange_refGene or dist_to_genes'] }}</td>
                                        {% if i['Disorder'] is string %}
                                            <td>{{ i['Disorder'] }}</td>
                                        {% else %}
                                            <td>{{ i['Disorder']|join(',') }}</td>
                                        {% endif %}
                                        <td>{{ i['NumProbands'] }}</td>
                                        <td>{{ i['NumControls'] }}</td>
                                        <td>
                                            <a href="https://www.ncbi.nlm.nih.gov/pubmed/{{ i['PMID'] }}">{{ i['1st author'] }}</a>
                                        </td>
                                        <td>{{ i['Study_scale'] }}</td>
                                        <td>{{ i['Individual ID'] }}</td>
                                        <td>{{ i['dbSNP'] }}</td>
                                        <td>{{ i['1000G_Freq'] }}</td>
                                        <td>{{ i['ExAC_Freq'] }}</td>
                                        <td>{{ i['SIFT_score'] }}</td>
                                        <td>{{ i['Polyphen2_HDIV_score'] }}</td>
                                        <td>{{ i['CADD_phred'] }}</td>
                                        <td>{{ i['DeepSeaScore'] }}</td>


                                    </tr>
                                    {% else %}
                                        <tr>
                                        <td><input type="radio" name="checkItem"/></td>
                                        <td class="chr">{{ i['chr'] }}</td>
                                        <td class="pos">{{ i['Position'] }}</td>
                                        <td>{{ i['Variant'] }}</td>
                                        {% if i['Gene symbol'] is string %}
                                            <td>{{ i['Gene symbol'] }}</td>
                                        {% else %}
                                            <td>{{ i['Gene symbol']|join(',') }}</td>
                                        {% endif %}
                                        <td>{{ i['Exonic Func'] }}</td>
                                        <td>{{ i['AAChange_refGene or dist_to_genes'] }}</td>
                                        {% if i['Disorder'] is string %}
                                            <td>{{ i['Disorder'] }}</td>
                                        {% else %}
                                            <td>{{ i['Disorder']|join(',') }}</td>
                                        {% endif %}
                                        <td>{{ i['NumProbands'] }}</td>
                                        <td>{{ i['NumControls'] }}</td>
                                        <td>
                                            <a href="https://www.ncbi.nlm.nih.gov/pubmed/{{ i['PMID'] }}">{{ i['1st author'] }}</a>
                                        </td>
                                        <td>{{ i['Study_scale'] }}</td>
                                        <td>{{ i['Individual ID'] }}</td>
                                        <td>{{ i['dbSNP'] }}</td>
                                        <td>{{ i['1000G_Freq'] }}</td>
                                        <td>{{ i['ExAC_Freq'] }}</td>
                                        <td>{{ i['SIFT_score'] }}</td>
                                        <td>{{ i['Polyphen2_HDIV_score'] }}</td>
                                        <td>{{ i['CADD_phred'] }}</td>
                                        <td>{{ i['DeepSeaScore'] }}</td>


                                    </tr>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                        </div></div></div>

            <div id="table-ncdm">
            <div style="margin-top:20px;" class="little_title">
            <table><tr>
                        <td width="80%">
                            Noncoding <i>de novo</i> mutations (DNMs) of <i>{{ j['Symbol'] }}</i>
                        </td>
                        <td></td>
                        <td></td>
                        <td width="5%">
                            <button class="btn btn-success mysubmit2"  >Submit</button>
                        </td>
                            </tr>
                    </table>
            </div>

            <table data-class="table table-hover" data-toggle="table" data-pagination="true"
                   data-show-pagination-switch="true" data-page-size=10 data-search="true" data-search-on-enter-key="true" data-show-refresh="true">
                <thead style="background-color:#669999">
                <tr>
                    <th></th>
                    <th>Chr</th>
                    <th>Position</th>
                    <th>Variant</th>
                    <th>Gene</th>
                    <th>Function</th>
                    <th>Dist to gene</th>
                    <th>Primary Phenotype</th>
                    <th>#Probands</th>
                    <th>#Controls</th>
                    <th>Study</th>
                    <th>Sequence type</th>
                    <th>#Individual</th>
                    <th>rsID</th>
                    <th>1000G_Freq.</th>
                    <th>ExAc Freq.</th>
                    <th>SIFT</th>
                    <th>Ployphen-2</th>
                    <th>CADD</th>
                    <th>DeepSea</th>
                    <th>Enhancer Id</th>
                    <th>Enhancer Start</th>
                    <th>Enhancer End</th>
                    <th>Promoter Id</th>
                    <th>Promoter Start</th>
                    <th>Promoter End</th>
                </tr>
                </thead>
                <tbody>
                {% for i in j['DNM'] %}
                    {% if i['Exonic Func']=='null' %}
                        {% if loop.index == 1 %}
                            <tr>
                            <td><input type="radio" name="checkItem" checked/></td>
                            <td class="chr">{{ i['chr'] }}</td>
                            <td class="pos">{{ i['Position'] }}</td>
                            <td>{{ i['Variant'] }}</td>
                            {% if i['Gene symbol'] is string %}
                                <td>{{ i['Gene symbol'] }}</td>
                            {% else %}
                                <td>{{ i['Gene symbol']|join(',') }}</td>
                            {% endif %}
                            <td>{{ i['Func refGene'] }}</td>
                            {% if i['AAChange_refGene or dist_to_genes'] is string %}
                                <td>{{ i['AAChange_refGene or dist_to_genes'] }}</td>
                            {% else %}
                                <td>{{ i['AAChange_refGene or dist_to_genes']|join(',') }}</td>
                            {% endif %}
                            {% if i['Disorder'] is string %}
                                <td>{{ i['Disorder'] }}</td>
                            {% else %}
                                <td>{{ i['Disorder']|join(',') }}</td>
                            {% endif %}
                            <td>{{ i['NumProbands'] }}</td>
                            <td>{{ i['NumControls'] }}</td>
                            <td>
                                <a href="https://www.ncbi.nlm.nih.gov/pubmed/{{ i['PMID'] }}">{{ i['1st author'] }}</a>
                            </td>
                            <td>{{ i['Study_scale'] }}</td>
                            <td>{{ i['Individual ID'] }}</td>
                            <td>{{ i['dbSNP'] }}</td>
                            <td>{{ i['1000G_ALL'] }}</td>
                            <td>{{ i['ExAC_Freq'] }}</td>
                            <td>{{ i['SIFT_score'] }}</td>
                            <td>{{ i['Polyphen2_HDIV_score'] }}</td>
                            <td>{{ i['CADD_phred'] }}</td>
                            <td>{{ i['DeepSeaScore'] }}</td>
                            <td>{{ i['enhancerid'] }}</td>
                            <td>{{ i['e_start'] }}</td>
                            <td>{{ i['e_end'] }}</td>
                            <td>{{ i['promoterid'] }}</td>
                            <td>{{ i['p_start'] }}</td>
                            <td>{{ i['p_end'] }}</td>


                        </tr>
                        {% else %}
                            <tr>
                            <td><input type="radio" name="checkItem"/></td>
                            <td class="chr">{{ i['chr'] }}</td>
                            <td class="pos">{{ i['Position'] }}</td>
                            <td>{{ i['Variant'] }}</td>
                            {% if i['Gene symbol'] is string %}
                                <td>{{ i['Gene symbol'] }}</td>
                            {% else %}
                                <td>{{ i['Gene symbol']|join(',') }}</td>
                            {% endif %}
                            <td>{{ i['Func refGene'] }}</td>
                            {% if i['AAChange_refGene or dist_to_genes'] is string %}
                                <td>{{ i['AAChange_refGene or dist_to_genes'] }}</td>
                            {% else %}
                                <td>{{ i['AAChange_refGene or dist_to_genes']|join(',') }}</td>
                            {% endif %}
                            {% if i['Disorder'] is string %}
                                <td>{{ i['Disorder'] }}</td>
                            {% else %}
                                <td>{{ i['Disorder']|join(',') }}</td>
                            {% endif %}
                            <td>{{ i['NumProbands'] }}</td>
                            <td>{{ i['NumControls'] }}</td>
                            <td>
                                <a href="https://www.ncbi.nlm.nih.gov/pubmed/{{ i['PMID'] }}">{{ i['1st author'] }}</a>
                            </td>
                            <td>{{ i['Study_scale'] }}</td>
                            <td>{{ i['Individual ID'] }}</td>
                            <td>{{ i['dbSNP'] }}</td>
                            <td>{{ i['1000G_ALL'] }}</td>
                            <td>{{ i['ExAC_Freq'] }}</td>
                            <td>{{ i['SIFT_score'] }}</td>
                            <td>{{ i['Polyphen2_HDIV_score'] }}</td>
                            <td>{{ i['CADD_phred'] }}</td>
                            <td>{{ i['DeepSeaScore'] }}</td>
                            <td>{{ i['enhancerid'] }}</td>
                            <td>{{ i['e_start'] }}</td>
                            <td>{{ i['e_end'] }}</td>
                            <td>{{ i['promoterid'] }}</td>
                            <td>{{ i['p_start'] }}</td>
                            <td>{{ i['p_end'] }}</td>


                        </tr>
                        {% endif %}
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
            </div>
        {% endif %}
        {% endfor %}

        {% for j in message %}
        {% if j['CNV'] %}
            <div id="table-cnv">
            <div class="row">
                <div class="col-md-12">
                    <div class="little_title">
                           <i>De novo</i> copy number variations (CNVs) of <i>{{ j['Symbol'] }}</i>
            </div>



                    <table data-class="table table-hover" data-toggle="table" data-pagination="true"
                           data-show-pagination-switch="true" data-page-size=10>
                        <thead style="background-color:#669999">
                        <tr>

{#                            <th></th>#}
                            <th>Chr</th>
                            <th>Mutation Type</th>
                            <th>Band</th>
                            <th>Start</th>
                            <th>End</th>
                            <th>Disorder</th>
                            <th>Gene Symbols</th>

                        </tr>
                        </thead>
                        <tbody>
                        {% for i in j['CNV'] %}
                            <tr>
{#                                <td><input type="radio" name="checkItem"/></td>#}
                                <td>{{ i['chr'] }}</td>
                                <td>{{ i['mutation type'] }}</td>
                                <td>{{ i['Band'] }}</td>
                                <td class="start">{{ i['start'] }}</td>
                                <td class="end">{{ i['end'] }}</td>
                                {% if i['Disorder'] is string %}
                                    <td>{{ i['Disorder'] }}</td>
                                {% else %}
                                    <td>{{ i['Disorder']|join(',') }}</td>
                                {% endif %}
                                {% if i['genesymbol'] is string %}
                                    <td style="word-break:break-all; word-wrap:break-all;">{{ i['genesymbol'] }}</td>
                                {% else %}
                                    <td style="word-break:break-all; word-wrap:break-all;">{{ i['genesymbol']|join(',') }}</td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>

            </div>
            </div>
        {% endif %}
        {% endfor %}

    </div>
    <script type="text/javascript" src="/twitter-bootstrap/twitter-bootstrap-v2/docs/assets/js/jquery.js"></script>
    <script type="text/javascript"
            src="/twitter-bootstrap/twitter-bootstrap-v2/docs/assets/js/bootstrap-collapse.js"></script>
    <script>

        $(".mysubmit").click(function () {
            //定义一个数组
            {#var selectedData = [];#}
            var selectedData = "";
            //获取选中的复选框
            $(":radio:checked").each(function () {
                {#alert('Submitted, inquiring, please wait a moment!');#}
                //获取该节点最近的一个tr
                var tr = $(this).closest("tr");
                //获取当前行的各个列的数据,eq()的下标索引从0开始。
                var position = $(tr).find(".pos")[0].innerHTML;
                var chr = $(tr).find(".chr")[0].innerHTML;
                var gene_location = (window.location.href).split('/')[4];
                var location = 'coding-dnm';
                {#alert("/MutationDetails/"+'gene='+gene_location+',location='#}
                {#    +location+',position='+position+',chr='+chr);#}
                window.location.href = "/MutationDetails/"+'gene='+gene_location+',location='
                    +location+',position='+position+',chr='+chr;
            });
            });

        $(".mysubmit2").click(function () {
            //定义一个数组
            var selectedData = '';
            //获取选中的复选框
            $(":radio:checked").each(function () {
                //获取该节点最近的一个tr
                var tr = $(this).closest("tr");
                var position = $(tr).find(".pos")[0].innerHTML;
                var chr = $(tr).find(".chr")[0].innerHTML;
                var gene_location = (window.location.href).split('/')[4];
                var location = 'non-coding-dnm';
               window.location.href = "/MutationDetails/"+'gene='+gene_location+',location='
                    +location+',position='+position+',chr='+chr;
            });
            });

    </script>
    <script language="javascript" type="text/javascript" >
        function getMutationSelect()
        {
            {#alert(123);#}
         {#alert(document.getElementById("mutaion_type").value);#}
         var selected = document.getElementById("mutaion_type").value;
         if (selected=='cdm')
         {
            document.getElementById("table-cdm").style.display = "block";
             document.getElementById("table-ncdm").style.display = "none";
            document.getElementById("table-cnv").style.display = "none";
         }
         else if (selected=='ncdm')
         {
            document.getElementById("table-cdm").style.display = "none";
            document.getElementById("table-ncdm").style.display = "block";
            document.getElementById("table-cnv").style.display = "none";
         }
         else if (selected=='cnv')
         {
            document.getElementById("table-cdm").style.display = "none";
            document.getElementById("table-ncdm").style.display = "none";
             document.getElementById("table-cnv").style.display = "block";
         }
         else
         {
             document.getElementById("table-cdm").style.display = "block";
            document.getElementById("table-ncdm").style.display = "block";
             document.getElementById("table-cnv").style.display = "block";
         }
         {#document.getElementById("collapseOne").style.display = "none";#}
         {#document.getElementById("collapseTwo").style.display = "none"#}
         {#document.getElementById("nav").style.display = "none"//不显示#}
         {#document.getElementById("nav").style.display = "block"//显示#}
        }
    </script>
    <div class="footer">
    <div class="foot">
        <div class="row" style="left: 0; background-color:#669999; border: 0px ; text-align: center" >
            <div class="col-md-6"><a href="http://bmi.sjtu.edu.cn" target="_blank">SJTU - Biomedical Information Lab</a></div>
            <div class="col-md-6"><a href="http://bioinformatics.nenu.edu.cn/" target="_blank">NENU - Institute of Computational Biology</a></div>
        </div>
    <div class="row" style="left: 0 ; background-color:#669999; border: 2px;" >

        <div class="col-md-3"><a href="http://exac.broadinstitute.org/" target="_blank"><img src="/static/foot1.png" style="width: 150px; height: 50px"></a></div>
        <div class="col-md-3"><a href="http://www.bioinfo.org.cn/relative/dbSNP%20Home%20Page.htm" target="_blank"><img src="/static/foot2.jpg" style="width: 150px; height: 50px"></a></div>
        <div class="col-md-3"><a href="http://wannovar.wglab.org/" target="_blank"><img src="/static/foot3.png" style="width: 150px; height: 50px"></a></div>
        <div class="col-md-3"><a href="http://genome.ucsc.edu/" target="_blank"><img src="/static/foot4.png" style="width: 150px; height: 50px"></a></div>
    </div>

    </div>
        <div class="foot-p">

{#           <img class="line2" alt=""  src="/static/line2.png" style="width: 600px; height: 60px;" />#}
            <br />
            <p><small>© 2018 bmi.sjtu.edu.cn. All rights reserved.</small><br />
                <small>浙ICP备18030141号.</small></p>

        </div>
</div>

{% endblock %}